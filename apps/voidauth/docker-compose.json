{
    "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json",
    "schemaVersion": 2,
    "services": [
        {
            "name": "voidauth-db",
            "image": "postgres:18",
            "internalPort": 5432,
            "environment": [
                {
                    "key": "POSTGRES_PASSWORD",
                    "value": "${VOIDAUTH_DB_PASSWORD}"
                },
                {
                    "key": "TZ",
                    "value": "${TZ}"
                }
            ],
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data/postgres",
                    "containerPath": "/var/lib/postgresql/data"
                }
            ],
            "healthCheck": {
                "test": "pg_isready -U postgres -h localhost",
                "interval": "10s",
                "timeout": "5s",
                "retries": 5
            }
        },
        {
            "name": "voidauth",
            "image": "ghcr.io/voidauth/voidauth:1.9.0",
            "isMain": true,
            "internalPort": 3000,
            "dependsOn": {
                "voidauth-db": {
                    "condition": "service_healthy"
                }
            },
            "environment": [
                {
                    "key": "APP_URL",
                    "value": "${APP_PROTOCOL}://${APP_DOMAIN}"
                },
                {
                    "key": "STORAGE_KEY",
                    "value": "${VOIDAUTH_STORAGE_KEY}"
                },
                {
                    "key": "DB_HOST",
                    "value": "voidauth-db"
                },
                {
                    "key": "DB_PASSWORD",
                    "value": "${VOIDAUTH_DB_PASSWORD}"
                },
                {
                    "key": "DB_ADAPTER",
                    "value": "postgres"
                },
                {
                    "key": "APP_TITLE",
                    "value": "${VOIDAUTH_APP_TITLE}"
                },
                {
                    "key": "APP_COLOR",
                    "value": "${VOIDAUTH_APP_COLOR}"
                },
                {
                    "key": "SIGNUP",
                    "value": "${VOIDAUTH_SIGNUP}"
                },
                {
                    "key": "SIGNUP_REQUIRES_APPROVAL",
                    "value": "${VOIDAUTH_SIGNUP_REQUIRES_APPROVAL}"
                },
                {
                    "key": "MFA_REQUIRED",
                    "value": "${VOIDAUTH_MFA_REQUIRED}"
                },
                {
                    "key": "SMTP_HOST",
                    "value": "${VOIDAUTH_SMTP_HOST}"
                },
                {
                    "key": "SMTP_FROM",
                    "value": "${VOIDAUTH_SMTP_FROM}"
                },
                {
                    "key": "SMTP_PORT",
                    "value": "${VOIDAUTH_SMTP_PORT}"
                },
                {
                    "key": "SMTP_SECURE",
                    "value": "${VOIDAUTH_SMTP_SECURE}"
                },
                {
                    "key": "SMTP_USER",
                    "value": "${VOIDAUTH_SMTP_USER}"
                },
                {
                    "key": "SMTP_PASS",
                    "value": "${VOIDAUTH_SMTP_PASS}"
                },
                {
                    "key": "TZ",
                    "value": "${TZ}"
                }
            ],
            "volumes": [
                {
                    "hostPath": "${APP_DATA_DIR}/data/config",
                    "containerPath": "/app/config"
                }
            ]
        }
    ]
}